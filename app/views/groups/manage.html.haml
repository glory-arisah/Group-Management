-# = render partial: 'form'
%main.group-main
  %header
    %p
      %span= link_to "Delete Group", "/groups/#{@group.id}", data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete #{@group.name}, this action will delete all related comments." }, class: 'no-underline'

    %h2 Users in "#{@group.name}"

  -# users in current group
  - @group_users.each do |group_user|
    %section.users-in-group
      - @user_group = UserGroup.find_by(group: @group, user: group_user)
      - if user_role(@group, current_user) == "admin"
        %span #{group_user.username}
        - unless user_role(@group, group_user) != 'user'
          %button= link_to "Remove", "/groups/#{@group.id}/user_groups/#{@user_group.id}", data: { turbo_method: :delete }, class: 'remove-user no-underline'
      - else
        - if user_role(@group, group_user) == 'admin'
          %span #{group_user.username} - Admin
        - else
          %span= group_user.username
      %span

  -# other users on the platform
  %header
    %h2 Available Users on Platform
  - @other_users.each do |user|
    %section.other-users
      %span= user.username
      = simple_form_for [@group, @user_group], url: "/groups/#{@group.id}/user_groups", method: :post  do |f|
        = f.hidden_field :group_id, value: @group.id
        = f.hidden_field :user_id, value: user.id
        = f.hidden_field :role, value: 'user'
        = f.button :submit, value: 'Add User'
      %span

  = link_to "Back to Group", "/groups/#{@group.id}", class: 'back'
